<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<LINK href="game.css" rel="stylesheet" type="text/css">

<TITLE>Game Center Home</TITLE>

<OBJECT id="Shell" classid="CLSID:13709620-C279-11CE-A49E-4445535400"></OBJECT>
<OBJECT id=GACAgent classid="CLSID:EEE23ED6-D23F-4A2E-8E2B-66E327538FB3"></OBJECT>
<SCRIPT defer SRC="gamectr.js"></SCRIPT>

<SCRIPT>

//Define Localization Strings

L_SortAlpha_Text="Sorted by name";
L_SortMRU_Text="Sorted by most recently played";

//End Localization Strings

var g_GACAgent = GACAgent;

function GoToAlpha() {
	//#define SORT_ALPHA    0
	//#define SORT_MRU      1
	//#define SORT_LRU	    2
	//#define SORT_LARGEST  3
	//#define SORT_SMALLEST 4

    //We want sort alpha, so pass in a 0
    g_GACAgent.GetGameData(0,0);

    document.frames("idGameListIFrame").document.location.reload(true);
    SortAlphaString="<A ID='idAGameSortAnchor' class='textSecondary'>" + L_SortAlpha_Text + "</A>";
    document.all.idAGameSortAnchor.outerHTML=SortAlphaString;

    return(false);
}

function GoToMRU() {
	//#define SORT_ALPHA    0
	//#define SORT_MRU      1
	//#define SORT_LRU	    2
	//#define SORT_LARGEST  3
	//#define SORT_SMALLEST 4

    //We want sort MRU, so pass in a 1
    g_GACAgent.GetGameData(1,0);

    document.frames("idGameListIFrame").document.location.reload(true);
    SortMRUString = "<A ID='idAGameSortAnchor' class='textSecondary'>" + L_SortMRU_Text + "</A>";
    document.all.idAGameSortAnchor.outerHTML=SortMRUString;
	
    //GoTo("Home");
    return(false);
}

function ResizeIFrame()
{
	//Get the IFrame object
	var a=document.all.tags("IFRAME");
	//Get the cell object the IFrame Resides in
	a(0).style.width=20
	a(0).style.height=20;

	var b=document.all.item("idIFrameCell");
	
	var width=b.offsetWidth;
	var height=b.offsetHeight;
	
	height=height<43 ? 0:height-43;

	a(0).style.width = width;
	a(0).style.height = height;

	var c =  document.frames("idGameListIFrame").document.all.item("idCellLinkName");


	for(var i=0; i < c.length; i++) {
		var d = c(i);
		var width = (width < 200) ? 100 : width - 100;
		c(i).width = width;
		d = c(i);
	}

}

</SCRIPT>
<SCRIPT FOR="window" EVENT="onload" >
	//HighlightTables();
	ResizeIFrame();
	GoToMRU(); 
</SCRIPT>

</HEAD>

<BODY ONRESIZE="ResizeIFrame();" SCROLL="no"><!--<IMG class=stretchedBackground height=1000 id=BackgroundImage src="images/gradient_gamecenter.gif" width=1200>-->
<IMG class=backgroundimage src="images/game_stripes.gif">
<TABLE id="PageContentTable" class="PageContentTable">
    <!-- page title -->
	<TR ID=PageTitleRow CLASS="PageTitleRow">
      <TD CLASS="PageLeftSpacer">&nbsp;</TD>
        <TD ID=PageTitleCell>
         <SPAN ID="idSpanBanner" CLASS="banner"><ID ID="idBanner">Games</ID></SPAN><BR><BR>
         <SPAN ID="idSpanTitle" class="title"><ID ID="idTitle">What do you want to do?</ID></SPAN><BR><BR>
        </TD>
      </TR><!-- main content -->
  
      <TR ID=PageContentRow CLASS="PageContentRow">
        <TD CLASS="PageLeftSpacer">&nbsp;</TD>
        <TD ID=PageContentCell CLASS="PageContentCell">
          <TABLE ID=ContentDividerTable CLASS="ContentDividerTable">
            <TR ID=ContentDividerRow CLASS="ContentDividerRow">
              <TD ID=LeftContentCell CLASS="LeftContentCell">
                <TABLE STYLE="HEIGHT: 100%; WIDTH: 100%">
                  <TBODY>
                    <TR >
                      <!-- task list -->
                      <TD ID=TaskList1>
					    <SPAN ID="idSpanTaskTitle" class="textPrimary"><ID id="idTextPlay">Play a game</ID></SPAN><BR>
					    <SPAN ID="idSpanMRUGames" class="textSecondary"><A id="idAMRUGames" onclick="return GoToMRU();" href=""><ID id="idTextMRUGames">View most recent games</ID></A></SPAN><BR>
					    <SPAN ID="idSpanAlphaGames" class="textSecondary"><A id="idAAlphaSort" onclick="return GoToAlpha();" href=""><ID id="idTextAlphaSort">View games by name</ID></A></SPAN><BR><BR><BR>
					    <SPAN ID="idSpanOtherTasks" class="textPrimary"><ID id="idSpanOtherTasks">You can also</ID></SPAN><BR>
					    <SPAN ID="idSpanTipsNCheats" class="textSecondary"><A id="idATipsNCheats" onclick="return GoTo('Game Tips')" href=""><ID id="idTextTips">Read game news</ID></A></SPAN><BR>
					    <SPAN ID="idSpanOnlineGames" class="textSecondary"><A id="idAOnlineGames" onclick="return GoTo('Online Gaming')" href=""><ID id="idTextWebGames">Play Web games</ID></A></SPAN><BR>
					    <SPAN ID="idSpanDiskMngmt" class="textSecondary"><A id='idADiskMngmt"' onclick ="return GoTo('Delete')" href=""><ID id="idTextRemoveGames">Remove games</ID></A></SPAN><BR>
					    <SPAN ID="idSpanGameCtrl" class="textSecondary"><A id="idAGameCtrl" onclick="shellExec('joy.cpl',false)" href=""><ID id="idTextConfigCtrl">Configure game controllers</ID></A></SPAN><BR>
					</TD>
				  </TR>
				</TBODY>
			  </TABLE>
			</TD><!-- End Left Content Cell -->
            <TD ID=RightContentCell CLASS="RightContentCell">
             <TABLE STYLE="HEIGHT:100%; WIDTH:100%">
				<TBODY>
                  <TR STYLE="HEIGHT:100%; WIDTH:100%" >
                    <TD class="ListGameCell">
					  <SPAN ID="idSpanSelectTask" class="textPrimary"><A ID="idASelectGame" class="textPrimary"><ID ID="idSelectGame">Click a game to play it</ID></A></SPAN><BR><BR>
		              <SPAN ID="idSpanSelectSubTask" class="textSecondary"><A ID="idAGameSortAnchor" class="textSecondary"></A></SPAN><BR><BR>              	  
					  <TABLE WIDTH="100%" HEIGHT="100%">
					    <TBODY>
						  <TR WIDTH="100%">
						    <TD ID="idIFrameCell" WIDTH="100%" HEIGHT="100%">
							  <IFRAME ID="idGameListIFrame" class="GameFrame" name=MainFrame FRAMEBORDER=0 src="sortmru.htm"></IFRAME>
						    </TD>
						  </TR>
						  <TR WIDTH="100%">
						  	<TD WIDTH="100%" HEIGHT="20">
							  <A ID="idACustomize" class="textTertiary" VALIGN="bottom"><SPAN ID="idSpanCustomize" class="InactiveLink"><ID ID="idCustomize">Customize this page</ID></SPAN></A>						    
						    </TD>
						  </TR>
						</TBODY>
					  </TABLE>
                    </TD>  
                  </TR>
                </TBODY>
			  </TABLE>
            </TD><!-- End Rignt Content Cell -->
          </TR><!-- End ContentDividerRow-->
        </TABLE><!-- End ContentDividerTable-->
      <TD><!-- End PageContentCell-->
   <TR><!-- End PageContentRow -->
   </TR>
 </TABLE>
</BODY>

</HTML>
