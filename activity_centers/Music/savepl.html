<HTML>
    <HEAD>
        <LINK REL="stylesheet" TYPE="text/css" HREF="music.css">
        </LINK>
        <TITLE>
            My music Playlist
        </TITLE>
        <SCRIPT SRC="musicctr.js">
        </SCRIPT>
    <SCRIPT>
    function EnableDisableButtons()
    {
        var el = event.srcElement;
        
        if((s_fButtonEnabled == false) && (el.value.length > 0))
        {
            btnSaveYourPlaylist.disabled = false;
            btnSaveAndPlay.disabled = false;
            s_iButtonEnabled = true;
        }
        else
        {
            if((s_fButtonEnabled == true) && (el.value.length == 0))
            {
                btnSaveYourPlaylist.disabled = true;
                btnSaveAndPlay.disabled = true;
                s_iButtonEnabled = false;
            }
        }
        event.returnValue = true;
    }
    
    </SCRIPT>
    </HEAD>
    
    <SCRIPT DEFER>
    var s_iCurPlaylist = null;
    var s_fButtonEnabled = false;
    var L_TypeHere_Text = "Type here";
    
    function InitSavePlaylist()
    {
        s_iCurPlaylist = external.Property("ObjCurMusicPlaylist");
        if(s_iCurPlaylist)
        {
            var i;
            //Remove the existing tracks from the playlist
            PlayListTracks.innerHTML = "";
            
            //Now, add the tracks from the playlist.
            for(i = 0; i < s_iCurPlaylist.Tracks; i++)
            {
                PlayListTracks.innerHTML += "<BR>"+s_iCurPlaylist.GetTrackProperty(i, "Title");
            }
            
            var NameOfPlaylist = external.Property("CurMusicPlaylistName");
            
            if(NameOfPlaylist != "")
                GivenPlaylistName.value = NameOfPlaylist;
            else
                GivenPlaylistName.value = L_TypeHere_Text;
        }
    }
    
    function SavePlaylist(playlist, NameOfPlaylist)
    {
        external.Property("CurMusicPlaylistName") = NameOfPlaylist;
        playlist.Save(NameOfPlaylist);
    }
    
    function SaveAndPlay(playlist, NameOfPlaylist)
    {
        //First of all Save the playlist.
        SavePlaylist(playlist, NameOfPlaylist);
        
        //Set the player to play the given playlist.
        var player = external.Property("Player");
        player.Stop();
        player.SetMusicPlaylist(playlist);
        player.Play();
    }
    
    function OnTransitionComplete(from, to)
    {
        // We need to initialize the listbox everytime we transition to this page because the
        // list could have changed in other places.
        if(to == "SavePlaylist")
            InitSavePlaylist();
    }
    
    function Init()
    {
        external.event.registerSink("Place.TransitionComplete", OnTransitionComplete, true);
    }
    
    </SCRIPT>
    
    <BODY SCROLL="no" ONLOAD="Init();InitSavePlaylist()"><!-- background images -->
        <DIV CLASS="bottomleftimage">
        <!-- the main table -->
        <TABLE CLASS="fullpage" ONRESIZE="PositionPlayer();">
            <TR STYLE="WIDTH:100%;">
                <TD CLASS="aligntop" STYLE="WIDTH:100%;">
                    <TABLE STYLE="WIDTH:100%;">
                        <TR STYLE="height: 25px;">
                            <TD STYLE="width: 46px;">
                            </TD>
                        </TR>
                        <TR>
                            <TD>    <!--empty column-->
                            </TD>
                            <TD>
                                <DIV CLASS="commandtitle">
                                    <ID ID=IDINSERTCD>Name and save your playlist</ID>
                                </DIV>
                            </TD>
                        </TR>
                        <TR  STYLE="HEIGHT: 15px">  <!-- Empty row -->
                            <TD>    <!-- Empty Column -->
                            </TD>
                        </TR>
                        <TR CLASS="rowaboveplayer">
                            <TD>
                            </TD>
                            <TD> <!-- This column has a table divided into three columns -->
                                <TABLE STYLE="HEIGHT:100%">
                                    <TD valign="top">
                                        <TABLE>
                                            <TR>
                                                <TD>
                                                    <SPAN CLASS="smallinstructionstitle"><ID ID="playlistname">Playlist name: </ID></SPAN>
                                                    <BR>
                                                    <INPUT TYPE="text" NAME="GivenPlaylistName" VALUE="Type here" ID="EnteredPlaylistName" SIZE=30 MAXLENGTH=50 ONKEYUP="EnableDisableButtons()">
                                                </TD>
                                            </TR>
                                            <TR  STYLE="HEIGHT:15px">
                                                <TD>
                                                </TD>
                                            </TR>
                                            <TR>
                                                <TD>
                                                    <BUTTON id="btnSaveYourPlaylist" OnClick="SavePlaylist(s_iCurPlaylist, GivenPlaylistName.value);return GoTo('MyMusic');">Save</BUTTON>
                                                    <BUTTON id="btnSaveAndPlay" OnClick="SaveAndPlay(s_iCurPlaylist, GivenPlaylistName.value);return GoTo('MyMusic');">Save and Play</BUTTON>
                                                    <BUTTON id="btnCancel" OnClick="return GoTo('MyMusic');">Cancel</BUTTON>
                                                </TD>
                                            </TR>
                                        </TABLE>
                                    </TD>
                                    <TD valign="top" STYLE="WIDTH:50%">
                                        <DIV CLASS="SelectedSongs" STYLE="WIDTH:100%">
                                            <SPAN CLASS="unknowninfotitle"><ID ID="playlistheader">Tracks in this playlist:</ID></SPAN>
                                            <BR>
                                            <DIV ID="PlayListTracks"></DIV>
                                        </DIV>
                                    </TD>
                                    <TD STYLE="WIDTH:15px">
                                    </TD>
                                </TABLE>
                            </TD>
                        </TR>
                    </TABLE>
                </TD>
            </TR>
            <TR>
                <TD>
                    <DIV ID=Master CLASS="playercell">
                    </DIV>
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>

