<HTML>

    <HEAD>
        <LINK REL="stylesheet" TYPE="text/css" HREF="music.css"></LINK>
        <TITLE>CD Home Page</TITLE>
        <SCRIPT SRC="musicctr.js"></SCRIPT>
    </HEAD>
    <!--  SCRIPT functions specific to Playlist -->

<!-- Playlist specific scipt functions  -->    
<SCRIPT  src="playlist.js">
</SCRIPT>
    
    
 <SCRIPT DEFER>
    var s_iSelected = -1; //This is a zero based index of the track selected.
    var s_CurList = null;
    var s_fDirty = false;
    
    function EditPlaylistInit()
    {
            s_player = external.Property("Player");
            //Check to see if we already have a playlist selected
            s_CurList = external.Property("ObjCurMusicPlaylist");
            //Initialize the listbox with the items in the playlist
            if(s_CurList != null)
                InitListBoxWithPlaylist(s_CurList);
    }
    
    function OnTransitionComplete(from, to)
    {
        if(to == "EditPlaylist")
        {
            // Everytime we transition to this place, we need to initialize the listbox
            // because it could have been edited in other places.
            EditPlaylistInit();
        }
    }
    
    // Initialization function gets called only once during Onload()!
    function Init()
    {
        s_iSelected = -1;
        s_CurList = null;
        s_fDirty = false;
        external.event.registerSink("Place.TransitionComplete", OnTransitionComplete, true);
    }
    
    function OnAddToPlaylist()
    {
        external.Property("fNewPlaylist") = 0; //This is an existing playlist.
        return GoTo('MusicPlaylist');
    }
    
    function Playlist_SetButtonStates()
    {
/*******  THIS CODE IS COMMENTED OUT BECAUSE DISABLING THE BUTTONS CAUSES PAINTING PROBLEMS ***
        if(s_iSelected == -1)
        {
            //Nothing is selected.
            btnMoveUp.disabled = true;
            btnMoveDown.disabled = true;
            btnRemove.disabled = true;
            btnRepeat.disabled = true;
        }
        else
        {
            //Something is selected.
            //Enable the Remove button.
            btnRemove.disabled = false;
            //Enable the Repeat button.
            btnRepeat.disabled = false;
            
            //If first track is selected, disable move up!
            if(s_iSelected > 0)
                btnMoveUp.disabled = false;
            else
                btnMoveUp.disabled = true;
                
            //If the last track is selected, disable movedown!
            if(s_iSelected < (s_CurList.Tracks -1))
                btnMoveDown.disabled = false;
            else
                btnMoveDown.disabled = true;
        }
         if(s_fDirty)
        {
            btnSave.disabled = false;
            btnCancel.disabled = false;
            s_fDirty = false;
        }
  ****************/
    }

 </SCRIPT>
 
<BODY SCROLL="no" STYLE="MARGIN: 0px" ONLOAD="Init();EditPlaylistInit()">
    <DIV CLASS="bottomleftimage">
    <TABLE CLASS="fullpage" ONRESIZE="PositionPlayer();">
        <TR STYLE="WIDTH:100%;">
            <TD CLASS="aligntop" STYLE="WIDTH:100%;">
                <TABLE STYLE="WIDTH:100%;">
                    <!-- padding on the left and top -->
                    <TR STYLE="height: 25px;">
                        <TD STYLE="width: 46px;">
                        </TD>
                    </TR>
                    <TR CLASS="rowaboveplayer">
                        <!-- skip the column -->
                        <TD>
                        </TD>
                        <TD>
                            <TABLE>
                                <TR>
                                    <TD>
                                        <SPAN CLASS="commandtitle"><ID id="change_your">Change your playlist</ID>
                                        </SPAN>
                                    </TD>
                                </TR>
                                <TR  STYLE="height:15px">
                                    <TD>
                                    </TD>
                                </TR>

                                <TR>
                                    <TD>
                                        <TABLE>
                                            <TD valign="top" STYLE="WIDTH:30%">
                                                <TABLE>
                                                    <TR>
                                                        <TD>
                                                            <SPAN CLASS="instructiontext">
                                                                    <ID  ID="Play_a_CD_the_way">Order a playlist the way you want. You can change the order of the tracks. You can also remove or repeat tracks.</ID>
                                                            </SPAN>
                                                        </TD>
                                                    </TR>
                                                    <TR STYLE="height:30px">
                                                        <TD>
                                                        </TD>
                                                    </TR>
                                                    <TR>
                                                        <TD>
                                                            <SPAN CLASS="smallinstructionstitle"><ID ID="youcanalso">You can also:</ID></SPAN><BR>
                                                            <SPAN CLASS="alsotext"><A id="link_play_some" ONCLICK="return GoTo('')" HREF=""><ID ID="Play_some_song">Play selected songs</ID></A><BR>
                                                            <A id="link_Change a playlist" ONCLICK="return GoTo('ChoosePlaylist')" HREF=""><ID ID="Change_a_Play">Change a playlist</ID></A></SPAN><BR>
                                                            <SPAN CLASS="alsotext">
                                                                <A id="Delete_from_my_music" CLASS="tasksubdisabled" ONCLICK="return GoTo('')" HREF=""><ID ID="DeleteFromMyMusic">Delete from My Music</ID></A>
                                                            </SPAN>
                                                            <BR>
                                                            <SPAN CLASS="alsotext">
                                                                <A id="open_my_music" CLASS="tasksubdisabled" ONCLICK="return GoTo('')" HREF=""><ID ID="OpenMyMusic">Open My Music folder</ID></A>
                                                            </SPAN>
                                                            <BR>
                                                            <BR><BR></P>
                                                        </TD>
                                                    </TR>
                                                </TABLE>
                                            </TD>
                                            <TD>
                                                <TABLE>
                                                    <TR>
                                                        <td width=40%>
                                                            <DIV ID=PlaylistBox CLASS="ListBox" onclick="Playlist_OnClick();">Playlist</DIV>
                                                        </td>
                                                        <td width=23%>
                                                            <TABLE>
                                                                <TD STYLE="WIDTH:15px">
                                                                </TD>
                                                                <TD>
                                                                    <SPAN CLASS="verysmallinstructions">
                                                                           <ID id=buttoninstruction>Click a track in the playlist, then click the option you want.</ID>
                                                                    </SPAN>
                                                                    <DIV ID="Tools" align="center">
                                                                        <BR>
                                                                        <BUTTON id=btnMoveUp CLASS="PLBUTTON"  OnClick="Playlist_MoveUp(s_iSelected)" >Move up in playlist</BUTTON>
                                                                        <BR>
                                                                        <BR>
                                                                        <BUTTON id=btnMoveDown CLASS="PLBUTTON"  OnClick="Playlist_MoveDown(s_iSelected)" >Move down in playlist</BUTTON>
                                                                        <BR>
                                                                        <BR>
                                                                        <BUTTON id=btnRemove CLASS="PLBUTTON"  OnClick="Playlist_RemoveTrack(s_iSelected)">Remove from playlist</BUTTON>
                                                                        <BR>
                                                                        <BR>
                                                                        <BUTTON id=btnRepeat CLASS="PLBUTTON"  OnClick="Playlist_RepeatTrack(s_iSelected)">Repeat in playlist</BUTTON>
                                                                        <BR>
                                                                        <BR>
                                                                        <BUTTON id=btnAddToPlaylist CLASS="PLBUTTON"  OnClick="return(OnAddToPlaylist())">Add to playlist</BUTTON>
                                                                    </DIV>
                                                                </TD>
                                                                <TD STYLE="WIDTH:15px">
                                                                </TD>
                                                            </TABLE>
                                                        </td>
                                                    </TR>
                                                    <TR>
                                                        <!-- The Total playback time cell -->
                                                        <TD width = 30% valign="top" COLSPAN=2>
                                                            <SPAN CLASS="alsotextdisabled"><ID id="TotalPlayback">Total playback time:</ID><SPAN ID="PlaybackTime"></SPAN></SPAN>
                                                        </TD>
                                                    </TR>
                                                    <TR STYLE="HEIGHT:15px">
                                                        <TD>
                                                        </TD>
                                                    </TR>
                                                    <TR >
                                                        <!-- The Save and cancel buttons  -->
                                                        <TD width = 16% COLSPAN=2>
                                                            <BUTTON ID="btnSave"  ONCLICK="return GoTo('SavePlaylist')">Save Playlist</BUTTON>
                                                            <BUTTON ID="btnCancel"  ONCLICK="return GoTo('MyMusic')">Cancel</BUTTON>
                                                        </TD>
                                                    </TR>
                                                </TABLE>
                                            </TD>
                                        </TABLE>
                                    </TD>
                                </TR>
                            </TABLE>
                        </TD>
                    </TR>
                </TABLE>
            </TD>
        </TR>
        <TR>
            <TD>
                <DIV ID=Master CLASS="playercell">
                </DIV>
            </TD>
        </TR>
    </TABLE>
</BODY>
</HTML>

