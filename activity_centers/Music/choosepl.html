<HTML>
    <HEAD>
        <LINK REL="stylesheet" TYPE="text/css" HREF="music.css">
        </LINK>
        <TITLE>Choose Playlist</TITLE>
        <SCRIPT SRC="musicctr.js">
        </SCRIPT>
    </HEAD>

<SCRIPT>
var s_CurMusicPlaylistName = null;

function RefreshNameSpaceControl()
{
    // In this page, the namespace control is always in "Playlist" view.
    // So, we refresh the control by changing the view to the current view.
    ChangeView(3);  // 3 => Playlist view.
}

function OnTransitionComplete(from, to)
{
    if(to == "ChoosePlaylist")
    {
        //We are coming back to this page; Refresh it once again because new playlists
        // could have been added.
        RefreshNameSpaceControl();
    }
}

function Init()
{
    external.event.registerSink("Place.TransitionComplete", OnTransitionComplete, true);
    //To refresh the namespace control, we Navigate once at the begining.
    RefreshNameSpaceControl();
}

//Someone clicked on an item in the list of playlists.
function OnPlaylist()
{
    var item = NameSpace.selectedItem;
    //alert("Is this a folder? "+item.isFolder);
    //alert("Name of this item:"+item.Name);
    //alert("Path of this item:"+item.Path);
    //alert("Type of this item:"+item.Type);
    if (item && item.isFolder)
    {
        //Select the playlistname
        s_CurMusicPlaylistName = item.Name;
        //enable the OK button.
        btnOK.disabled = false;    
    }
    else
        btnOK.disabled = true;
}

function LoadMusicPlaylist()
{
    
    //BUGBUG: If we already have a playlist we must free it! How do we do it?
    var oldPlaylist = external.Property("ObjCurMusicPlaylist");
    if(oldPlaylist != null)
        delete oldPlaylist;
    
    var newList = external.Property("Player").NewPlaylist;
    newList.Load(s_CurMusicPlaylistName);
    external.Property("CurMusicPlaylistName") = s_CurMusicPlaylistName; //Save the name!
    external.Property("ObjCurMusicPlaylist") = newList;                 //Save the object!
    external.Property("fNewPlaylist") = 0; //Is this a new playlist? No!
    
    return GoTo('EditPlaylist')  //Go to edit the playlist we just chose!
}

</SCRIPT>

<SCRIPT language="JavaScript" for="NameSpace" event="SelectionChange">
    OnPlaylist();
</SCRIPT>

<SCRIPT language="JavaScript" for="NameSpace" event="DoubleClick">
    OnPlaylist();
</SCRIPT>

    <BODY SCROLL="no" ONLOAD="Init()"><!-- background images -->
        <DIV CLASS="bottomleftimage">
        <!-- the main table -->
        <TABLE CLASS="fullpage" ONRESIZE="PositionPlayer();">
            <TR STYLE="WIDTH:100%;">
                <TD CLASS="aligntop" STYLE="WIDTH:100%;">
                    <TABLE STYLE="WIDTH:100%;">
                        <TR STYLE="height: 25px;">
                            <TD STYLE="width: 46px;">
                            </TD>
                        </TR>
                        <TR>
                            <TD>    <!--empty column-->
                            </TD>
                            <TD>
                                <DIV CLASS="commandtitle">
                                    <ID  ID=IDINSERTCD>Choose the playlist you want</ID>
                                </DIV>
                            </TD>
                        </TR>
                        
                        <TR  STYLE="HEIGHT: 15px">  <!-- Empty row -->
                            <TD>    <!-- Empty Column -->
                            </TD>
                        </TR>
                        
                        <TR CLASS="rowaboveplayer">
                            <TD>    <!-- Empty Column -->
                            </TD>
                            <TD> <!-- This column has a table divided into three columns -->
                                <TABLE STYLE="HEIGHT: 100%; WIDTH:100%">
                                    <TR>
                                        <TD STYLE="WIDTH:30%" valign="top">
                                            <TABLE>
                                                <TR>
                                                    <TD>
                                                    <DIV ID="ClickThePlaylist" CLASS="smallinstructions">1. Click a playlist to select it.</DIV>
                                                        <BR>
                                                    <DIV ID="ClickOK" CLASS="smallinstructions">2. Click <B>OK</B>.</DIV>
                                                        <BR>
                                                    </TD>
                                                </TR>
                                                <TR STYLE="HEIGHT:30px">
                                                    <TD>
                                                    </TD>
                                                </TR>
                                                <TR>
                                                    <TD>
                                                    <SPAN CLASS="smallinstructionstitle"> <ID ID="AlsoText">You can also:</ID>
                                                    </SPAN>
                                                    <BR>
                                                    <SPAN CLASS="alsotext">
                                                        <A ID="Create_a_playlist" ONCLICK="return OnCreateNewPlaylist()" HREF=""><ID ID="Create_a_plist">Create a playlist</ID></A>
                                                        <BR>
                                                        <A ID="Add_To_My_Music" ONCLICK="return GoTo('Import Music')" HREF=""><ID ID="Add_To_My_Mus">Search for music on my computer</ID></A>
                                                        <BR>
                                                        <A ID="Delete_From_My_Music" CLASS="alsotextdisabled" ONCLICK="return GoTo('')" HREF=""><ID ID="Delete_From_My_Mus">Delete from My Music</ID></A>
                                                        <BR>
                                                        <A ID="Open_my_music" CLASS="alsotextdisabled" "ONCLICK="return GoTo('MyMusic')" HREF=""><ID ID="Open_My_Folder">Open My Music folder</ID></A>
                                                    </SPAN>
                                                    </TD>
                                                </TR>
                                            </TABLE>
                                        </TD>
                                        <TD STYLE="WIDTH:50%">
                                            <TABLE STYLE="WIDTH:100%;HEIGHT:100%">
                                                <TR STYLE="HEIGHT:70%">
                                                    <TD COLSPAN=2 STYLE="background-color:#b8def9">
                                                        <OBJECT ID=NameSpace CLASSID="clsid:55136805-B2DE-11D1-B9F2-00A0C98BC547" WIDTH=100% height=100%>
                                                            <PARAM NAME="root" VALUE="shell:::{A77BADF8-BD51-4b4d-B224-21802ED9695D}"> <!--"shell:drivefolder"-->
                                                            <PARAM NAME="mode" VALUE="9"> <!--  9 -->
                                                            <PARAM NAME="flags" VALUE="3"> <!-- 6 Single Selection -->
                                                            <PARAM NAME="enumoptions" VALUE="32">
                                                            <PARAM NAME="columns" VALUE="name;type;size">
                                                        </OBJECT>
                                                    </TD>
                                                    <TD STYLE="WIDTH:15px">
                                                    </TD>
                                                </TR>
                                                <TR STYLE="HEIGHT:30%">
                                                    <TD valign="top">
                                                        <TABLE>
                                                            <TR>
                                                                <TD STYLE="HEIGHT:15px">
                                                                </TD>
                                                            </TR>
                                                            <TR>
                                                                <TD>
                                                                    <BUTTON id="btnOK" DISABLED="true" OnClick="return LoadMusicPlaylist()">OK</DIV>
                                                                </TD>
                                                            </TR>
                                                        </TABLE>
                                                    </TD>
                                                </TR>
                                            </TABLE>
                                        </TD>
                                    </TR>
                                </TABLE>
                            </TD>
                        </TR>
                    </TABLE>
                </TD>
            </TR>
            <TR>
                <TD>
                    <DIV ID=Master CLASS="playercell">
                    </DIV>
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>

