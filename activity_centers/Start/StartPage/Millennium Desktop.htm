<HTML xmlns:start>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<TITLE>Windows Start Page</TITLE>
<link rel=stylesheet type="text/css" href="">

<OBJECT id=ACHelp CLASSID="CLSID:f14b8060-3ef5-11d3-85be-006097df8c11">
</OBJECT>

<SCRIPT LANGUAGE="javascript">
// As soon as possible, figure out what theme to use.  Do this even before
// the page content loads to avoid flicker.
document.styleSheets(0).href = "scheme/" + ACHelp.desktopTheme + "/desktop.css";
</SCRIPT>

<STYLE type="text/css">
start\:LOADXML { behavior: url(loadxml.htc); }
start\:DESKITEMS { behavior: url(deskitems.htc); }
</STYLE>

<OBJECT ID=MyProgramsManager
   CLASSID="CLSID:FCB7C58F-FBDD-497D-B3CB-60FEBE6DC247">
   <PARAM NAME="maxItems" VALUE=6>
</OBJECT>

<OBJECT ID=MyFilesManager
   CLASSID="CLSID:FCB7C590-FBDD-497D-B3CB-60FEBE6DC247">
   <PARAM NAME="maxItems" VALUE=8>
</OBJECT>

<OBJECT id=Shell
    CLASSID="CLSID:13709620-C279-11CE-A49E-4445535400">
</OBJECT>

<object id=DesktopFSNotify
   CLASSID="CLSID:155ADB29-10FD-4CC1-B0C0-F2718CCBB60C">
   <PARAM NAME="folderitem" VALUE="shell:desktopfolder">
</object>

<object id=MyProgramsFSNotify
   CLASSID="CLSID:155ADB29-10FD-4CC1-B0C0-F2718CCBB60C">
   <PARAM NAME="recursive" VALUE=true>
</object>

<script language="javascript" FOR="window" EVENT="onload">

var g_xsl;

g_xsl = new ActiveXObject("Microsoft.XMLDOM");
g_xsl.async = true;
g_xsl.onreadystatechange = g_XSLReady;
g_xsl.load("banner.xsl");

function g_XSLReady()
{
    if (g_xsl.readyState == 4)
    {
        idStartingPlaces.xsl = g_xsl;
        idStartingPlaces.load();

        idMyPrograms.xsl = g_xsl;
        idMyPrograms.load();

      //idBanner.xsl = g_xsl;
      //idBanner.load();

        idMyFiles.xsl = g_xsl;
        idMyFiles.load();

        if (idMyPrograms.isDynamic)
        {
           MyProgramsFSNotify.folderitem = "shell:start menu";
           MyProgramsManager.recalc();
        }

        MyFilesManager.recalc();

    }
}

</SCRIPT>

<SCRIPT>
var g_idMyProgramsTimer;

// BUGBUG raymondc: HACK: Until we get our story straight, just auto-refresh
// this puppy if nothing has happened in 30 minutes.
function MyProgramsRefresh()
{
    idMyPrograms.load();
    if (g_idMyProgramsTimer)
        window.clearInterval(g_idMyProgramsTimer);
    g_idMyProgramsTimer = window.setInterval(MyProgramsRefresh, 30 * 60 * 1000);
}

</script>

<script language="JavaScript" for="ACHelp" event="ondesktopsettingschanged">
    window.location.reload();
</script>

<script language="JavaScript" for="MyFilesManager" event="onrecalcdone">
    idMyFiles.load();
</script>

<script language="JavaScript" for="DesktopFSNotify" event="OnFSNotifyChanged">
    MyFilesManager.recalc();
    
    // My programs also needs to refresh because it includes apps on the
    // the desktop
    if (idMyPrograms.isDynamic)
        MyProgramsManager.recalc();
</script>

<script language="JavaScript" for="MyProgramsManager" event="onrecalcdone">
    MyProgramsRefresh();
</script>

<script language="JavaScript" for="MyProgramsFSNotify" event="OnFSNotifyChanged">
    if (idMyPrograms.isDynamic)
        MyProgramsManager.recalc();
</script>

<script language="javascript" FOR="document" EVENT="onkeypress">
    if (window.event.keyCode == 27)
        idContextMenu.style.display = "none";
</script>

<script language="javascript" FOR="document" EVENT="ondragstart">
    return false;
</script>

<script DEFER>
function shellExec(cmd, arg)
{
    Shell.ShellExecute(cmd, arg);
    window.event.cancelBubble = true;
    window.event.returnValue = false;
}

function shellExecEvent()
{
    var e;
    for (e = window.event.srcElement; e.tagName != "A"; e = e.parentElement) { }
    shellExec(ACHelp.ACShellURLToPath(e.HREFEX), null);
}

function launchCustomize()
{
   shellExec("mshta.exe",
             ACHelp.ACShellURLToPath("shell:windows\\activity\\start\\spcust\\spcust.htm"));
}
</script>

<!-- Context menu stuff -->
<script language="javascript" FOR="document" EVENT="oncontextmenu">
    if (0)
    {
    idContextMenu.style.left = window.event.clientX;
    idContextMenu.style.top = window.event.clientY;
    idContextMenu.style.display = "block";
    idDebug.style.display = (event.altKey && event.ctrlKey) ? "block" : "none";
    idContextMenu.setCapture();
    return false;
    }
    if (window.event.srcElement.tagName == "A" ||
        window.event.srcElement.tagName == "IMG")
    {
        return false;
    }
    return true;
</script>

<script language="javascript" FOR="idContextMenu" EVENT="onclick">
    idContextMenu.style.display="none";
    idContextMenu.releaseCapture();
    var e = event.srcElement;
    if (e && (e.parentElement == idContextMenu || e.parentElement == idDebug)) {
        e.click();
    }
</script>

<script language="javascript" FOR="idContextMenu" EVENT="onmouseover">
    var e = event.srcElement;
    if (e && (e.parentElement == idContextMenu || e.parentElement == idDebug)) {
        e.className = "menuItemHot";
    }
</script>

<script language="javascript" FOR="idContextMenu" EVENT="onmouseout">
    var e = event.srcElement;
    if (e && (e.parentElement == idContextMenu || e.parentElement == idDebug)) {
        e.className = "menuItem";
    }
</script>

<script DEFER>

function setRes(x,y)
{
    idDebugFrame.style.top = 0;
    idDebugFrame.style.left = 0;
    idDebugFrame.style.width = x;
    idDebugFrame.style.height = y;
    idDebugFrame.style.backgroundColor = "white";
    idDebugFrame.style.zIndex = -3;
}

/*
 *  Debugging: Turn on borders for tables so we can see the layout.
 *  Ctrl key also turns on RTL.
 */
function HighlightTables(b)
{
    var a = document.all.tags("TABLE");
    var i;
    for (i = 0; i < a.length; i++) {
        a(i).border = b;
        a(i).dir = event.ctrlKey ? "rtl" : "ltr";
    }
}

</script>

</HEAD>


<BODY>
<div class="gradient1" style="position:absolute"></div>
<div class="gradient2" style="position:absolute"></div>
<div class="startimage1" style="position:absolute"></div>
<div class="startimage2" style="position:absolute"></div>
<div id=idDebugFrame style="position:absolute"></div>

<DIV id="idContextMenu" class="contextMenu" style="position:absolute;display:none">
<DIV class="menuItem" onclick="launchCustomize()"
><id id=L_customization2>Customize this page</id></DIV>
<!-- BUGBUG for debugging screen sizes -->
<DIV id=idDebug>
<DIV class="menuItem" onclick="setRes(0,0);HighlightTables(0)"
><id id=L_clear>clear</id></DIV>
<DIV class="menuItem" onclick="setRes(640,480)"
><id id=L_640x480>640 x 480</id></DIV>
<DIV class="menuItem" onclick="setRes(800,600)"
><id id=L_800x600>800 x 600</id></DIV>
<DIV class="menuItem" onclick="setRes(1024,768)"
><id id=L_1024x768>1024 x 768</id></DIV>
<DIV class="menuItem" onclick="HighlightTables(1)"
><id id=L_Highlight>Highlight</id></DIV>
</DIV>
</DIV>

<!-- Table layout:

    +-----+---------------------------------+--------------------------+
    |                                       |            ^             |
    |  Welcome                              |            |             |
    |                                       |           vcenter        |
    +-----+---------------------------------+                          |
    |               s p a c e r             | My Programs              |
    +-----+---------------------------------+                          |
    |     |                                 |                          |
    |     | Starting Places                 |                          |
    |     |                                 | My Files and Folders     |
    |     |                                 |                          |
    |     |                                 |                          |
    |     |                                 |                          |
    |     |                                 |                          |
    |     |                                 |                          |
    |     |                                 |           vcenter        |
    |     |                                 |            |             |
    |     |                                 |            v             |
    |     |                                 |                          |
    +-----+---------------------------------+--------------------------+
    |     |                                 |                          |
    |     |   Search                        |  Customize               |
    |     |                                 |                          |
    +-----+---------------------------------+--------------------------+


  -->

<!-- ****************************************************************************** -->

<TABLE WIDTH=100% HEIGHT=100%>
<TR>

    <!-- Welcome pane -->
    <TD COLSPAN=2>
        <img ID=idWelcome height=65 width=245 SRC="logo.gif">
    </TD>

    <!-- Banner pane -->
    <!--
        <start:LOADXML id=idBanner ASYNC lx_xmlfile="banner.xml"></start:LOADXML>
     -->

    <TD ROWSPAN=4>
        <TABLE HEIGHT=100% WIDTH=100%>
            <TR><TD VALIGN=center>
            <start:LOADXML id=idMyPrograms lx_xmlfile="myprograms.xml"></start:LOADXML>
            <br>
            <start:LOADXML id=idMyFiles lx_xmlfile="myfiles.xml"></start:LOADXML>
            </TD></TR>
            <TR><TD>
                <SPAN class="textSecondary">
                    <A onclick="launchCustomize()" HREF=":"
                    ><id id=L_customization>Customize this page</id></A>
                <P>
        </SPAN>
            </TD>
            </TR></TABLE>
</TR>

<TR HEIGHT=10>
    <TD COLSPAN=2></TD>
</TR>

<TR>

    <TD class=startplaceindent></TD>

    <TD VALIGN=top HEIGHT="66%">
        <start:LOADXML id=idStartingPlaces ASYNC
                       lx_xmlfile="startpl.xml"></start:LOADXML>
    </TD>

</TR>


<TR HEIGHT=20%>

    <SCRIPT DEFER>
    function selectSearch(me)
    {
        radiobutton1.checked = radiobutton2.checked = false;
        me.checked = true;
    }
    </SCRIPT>

    <TD class=startplaceindent></TD>

    <TD>
    <!-- search pane - currently disabled

        <DIV id="Search">
          <TABLE class="searcharea">
          <TR WIDTH=100%><TD COLSPAN=4>
            <span class="headerSecondary"><id id="L_Search">Search</id></span>
          </TD></TR>
          <TR><TD COLSPAN=4>
            <input type="text" name="textfield" size="25">
          </TD></TR>
          <TR>
          <TD>
            <input type="radio" name="radiobutton2" value="radiobutton" onclick="selectSearch(this)">
          </TD>
          <TD>
          <div id="InternetSearch" class="text_secondary"
               onclick="selectSearch(radiobutton2)">
            Internet</div>
          </TD>
          <TD>
            <input type="radio" name="radiobutton1" value="radiobutton" onclick="selectSearch(this)">
          </TD>
          <TD>
          <div id="FilesOrFoldersSearch" class="text_secondary"
               onclick="selectSearch(radiobutton1)">
            Files or Folders</div>
          </TD>
          </TR>
          </TABLE>
        </DIV>
    -->
    </TD>

</TR>
</TABLE>

</BODY>
</html>
